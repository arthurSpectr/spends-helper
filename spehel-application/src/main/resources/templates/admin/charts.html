<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Spehel charts</title>

    <!-- Load c3.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.css" integrity="sha512-GQSxWe9Cj4o4EduO7zO9HjULmD4olIjiQqZ7VJuwBxZlkWaUFGCxRkn39jYnD2xZBtEilm0m4WBG7YEmQuMs5Q==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Load d3.js and c3.js -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.js"></script>

    <link th:rel="stylesheet" th:href="@{/css/main.css}"/>
</head>

<body>

<div class="container">

    <h1 class="chart-header">Spends in charts</h1>

    <div class="chart">
        <div id="chart"></div>

        <script>

            var xmlHttp = new XMLHttpRequest();
            xmlHttp.open("GET", "/main-service/charts/info", false); // false for synchronous request
            xmlHttp.send(null);

            var json = JSON.parse(xmlHttp.responseText);

            var clickhandler = function(event) {
                window.location.replace('/main-service/chart');
            }

            var chart = c3.generate({
                size: {
                    width: 800,
                    height: 800
                },
                padding: {
                    top: 50
                },
                data: {
                    // iris data from R
                    // columns: [
                    //     ['data1', 30],
                    //     ['data2', 120],
                    // ],
                    columns: json.totalSpends,
                    onclick: function(event) { clickhandler(event) },
                    type : 'donut',
                    // onclick: function (d, i) { console.log("onclick", d, i); },
                    // onmouseover: function (d, i) { console.log("onmouseover", d, i); },
                    // onmouseout: function (d, i) { console.log("onmouseout", d, i); }
                },
                tooltip: {
                    format: {
                        title: function (d) { return 'Visual hint'; },
                        value: function (value, ratio, id) {
                            return value;
                        }
                    }
                },
                donut: {
                    title: json.totalSpendsSum + "â‚´",
                    label: {
                        threshold: 0.02,
                        format: function(value, ratio, id) {
                            return value;
                        }
                    }
                }
            });

        </script>
    </div>

</div>


</body>

</html>